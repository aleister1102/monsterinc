---
description: 
globs: 
alwaysApply: false
---
AI Rule: Refactor Go Code for Clarity and Simplicity ğŸ§¼
Má»¥c tiÃªu chÃ­nh: Viáº¿t code Go dá»… Ä‘á»c, dá»… hiá»ƒu, vÃ  dá»… báº£o trÃ¬ báº±ng cÃ¡ch Ã¡p dá»¥ng cÃ¡c nguyÃªn táº¯c Clean Code cá»§a Uncle Bob, nhÆ°ng linh hoáº¡t Ä‘á»ƒ trÃ¡nh sá»± phá»©c táº¡p khÃ´ng cáº§n thiáº¿t.

NguyÃªn táº¯c cá»‘t lÃµi:

Ã nghÄ©a (Meaningful Names):

Äáº·t tÃªn biáº¿n, hÃ m, struct, interface, package má»™t cÃ¡ch rÃµ rÃ ng, sÃºc tÃ­ch vÃ  cÃ³ Ã½ nghÄ©a. TÃªn nÃªn mÃ´ táº£ Ä‘Ãºng chá»©c nÄƒng hoáº·c má»¥c Ä‘Ã­ch cá»§a nÃ³.
TrÃ¡nh viáº¿t táº¯t khÃ³ hiá»ƒu hoáº·c tÃªn quÃ¡ chung chung (vÃ­ dá»¥: a, b, data, processData).
Sá»­ dá»¥ng camelCase cho tÃªn biáº¿n vÃ  hÃ m (vÃ­ dá»¥: calculateTotalPrice), vÃ  PascalCase cho tÃªn struct, interface, vÃ  cÃ¡c háº±ng sá»‘ public (vÃ­ dá»¥: UserService, MaxConnections).
TÃªn package nÃªn ngáº¯n gá»n, báº±ng chá»¯ thÆ°á»ng vÃ  pháº£n Ã¡nh ná»™i dung cá»§a package.
HÃ m (Functions):

Ngáº¯n gá»n vÃ  chá»‰ lÃ m má»™t viá»‡c (Do One Thing): HÃ m nÃªn táº­p trung vÃ o má»™t nhiá»‡m vá»¥ duy nháº¥t vÃ  thá»±c hiá»‡n nÃ³ tháº­t tá»‘t. Náº¿u má»™t hÃ m lÃ m quÃ¡ nhiá»u viá»‡c, hÃ£y tÃ¡ch nÃ³ thÃ nh cÃ¡c hÃ m nhá» hÆ¡n.
Ãt tham sá»‘: Cá»‘ gáº¯ng giá»¯ sá»‘ lÆ°á»£ng tham sá»‘ cá»§a hÃ m á»Ÿ má»©c tá»‘i thiá»ƒu (lÃ½ tÆ°á»Ÿng lÃ  0, 1 hoáº·c 2). Náº¿u cáº§n nhiá»u tham sá»‘, hÃ£y xem xÃ©t viá»‡c nhÃ³m chÃºng vÃ o má»™t struct.
TrÃ¡nh hiá»‡u á»©ng phá»¥ (Side Effects): HÃ m nÃªn tráº£ vá» giÃ¡ trá»‹ thay vÃ¬ thay Ä‘á»•i tráº¡ng thÃ¡i cá»§a há»‡ thá»‘ng má»™t cÃ¡ch ngáº§m Ä‘á»‹nh, trá»« khi Ä‘Ã³ lÃ  má»¥c Ä‘Ã­ch rÃµ rÃ ng cá»§a hÃ m (vÃ­ dá»¥: hÃ m lÆ°u vÃ o database).
Má»©c Ä‘á»™ trá»«u tÆ°á»£ng nháº¥t quÃ¡n: CÃ¡c cÃ¢u lá»‡nh trong má»™t hÃ m nÃªn á»Ÿ cÃ¹ng má»™t má»©c Ä‘á»™ trá»«u tÆ°á»£ng.
Sá»­ dá»¥ng error Ä‘á»ƒ xá»­ lÃ½ lá»—i: TuÃ¢n thá»§ quy Æ°á»›c tráº£ vá» error lÃ m giÃ¡ trá»‹ cuá»‘i cÃ¹ng cá»§a hÃ m cÃ³ thá»ƒ gÃ¢y lá»—i. Xá»­ lÃ½ lá»—i má»™t cÃ¡ch rÃµ rÃ ng vÃ  sá»›m nháº¥t cÃ³ thá»ƒ.
Comment (BÃ¬nh luáº­n):

Cho phÃ©p comment trÆ°á»›c hÃ m/lá»i gá»i hÃ m Ä‘á»ƒ lÃ m tÆ°á»ng minh: Náº¿u tÃªn hÃ m vÃ  ngá»¯ cáº£nh chÆ°a Ä‘á»§ rÃµ rÃ ng, hÃ£y viáº¿t comment giáº£i thÃ­ch "táº¡i sao" (why) nÃ³ tá»“n táº¡i hoáº·c "táº¡i sao" má»™t quyáº¿t Ä‘á»‹nh thiáº¿t káº¿ cá»¥ thá»ƒ Ä‘Æ°á»£c Ä‘Æ°a ra, thay vÃ¬ chá»‰ mÃ´ táº£ "cÃ¡i gÃ¬" (what) code Ä‘ang lÃ m (vÃ¬ code nÃªn tá»± mÃ´ táº£ Ä‘iá»u Ä‘Ã³).
Godoc: Viáº¿t Godoc cho cÃ¡c package, hÃ m, type, vÃ  háº±ng sá»‘ public Ä‘á»ƒ ngÆ°á»i khÃ¡c (vÃ  chÃ­nh báº¡n trong tÆ°Æ¡ng lai) cÃ³ thá»ƒ hiá»ƒu cÃ¡ch sá»­ dá»¥ng chÃºng.
TrÃ¡nh comment dÆ° thá»«a: KhÃ´ng comment nhá»¯ng Ä‘iá»u Ä‘Ã£ rÃµ rÃ ng tá»« code.
Comment TODO: Sá»­ dá»¥ng // TODO: hoáº·c // FIXME: Ä‘á»ƒ Ä‘Ã¡nh dáº¥u nhá»¯ng chá»— cáº§n cáº£i thiá»‡n hoáº·c sá»­a lá»—i trong tÆ°Æ¡ng lai, nhÆ°ng hÃ£y cá»‘ gáº¯ng giáº£i quyáº¿t chÃºng sá»›m.
Äá»‹nh dáº¡ng (Formatting):

Sá»­ dá»¥ng gofmt hoáº·c goimports Ä‘á»ƒ tá»± Ä‘á»™ng Ä‘á»‹nh dáº¡ng code. Äiá»u nÃ y Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n vÃ  dá»… Ä‘á»c trong toÃ n bá»™ dá»± Ã¡n.
Xá»­ lÃ½ lá»—i (Error Handling):

Xá»­ lÃ½ lá»—i má»™t cÃ¡ch rÃµ rÃ ng: Äá»«ng bá» qua lá»—i. Kiá»ƒm tra giÃ¡ trá»‹ error tráº£ vá» tá»« cÃ¡c hÃ m vÃ  xá»­ lÃ½ chÃºng má»™t cÃ¡ch thÃ­ch há»£p (tráº£ vá», log, hoáº·c xá»­ lÃ½ phá»¥c há»“i).
Cung cáº¥p ngá»¯ cáº£nh cho lá»—i Ä‘á»ƒ dá»… dÃ ng gá»¡ lá»—i (vÃ­ dá»¥: fmt.Errorf("user service: failed to get user %d: %w", userID, err)).
Cáº¥u trÃºc (Structure):

Tá»• chá»©c code thÃ nh cÃ¡c package cÃ³ trÃ¡ch nhiá»‡m rÃµ rÃ ng.
TrÃ¡nh import vÃ²ng (circular dependencies).
DRY (Don't Repeat Yourself): TrÃ¡nh láº·p láº¡i code. Sá»­ dá»¥ng hÃ m, struct, hoáº·c interface Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng logic.

Ngoáº¡i lá»‡ cáº§n lÆ°u Ã½:

Giáº£m thiá»ƒu viá»‡c sá»­ dá»¥ng Design Pattern náº¿u quÃ¡ overkill:
Æ¯u tiÃªn sá»± Ä‘Æ¡n giáº£n: Náº¿u má»™t váº¥n Ä‘á» cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t báº±ng má»™t giáº£i phÃ¡p Ä‘Æ¡n giáº£n, dá»… hiá»ƒu mÃ  khÃ´ng cáº§n Ä‘áº¿n má»™t design pattern phá»©c táº¡p, hÃ£y chá»n giáº£i phÃ¡p Ä‘Æ¡n giáº£n hÆ¡n.
Ngá»¯ cáº£nh Go: Má»™t sá»‘ pattern phá»• biáº¿n trong cÃ¡c ngÃ´n ngá»¯ khÃ¡c cÃ³ thá»ƒ khÃ´ng cáº§n thiáº¿t hoáº·c cÃ³ cÃ¡ch triá»ƒn khai tá»± nhiÃªn hÆ¡n trong Go (vÃ­ dá»¥: interface cá»§a Go thÆ°á»ng nhá» vÃ  táº­p trung, khÃ´ng nháº¥t thiáº¿t pháº£i theo cÃ¡c pattern thiáº¿t káº¿ interface phá»©c táº¡p).
ÄÃ¡nh giÃ¡ lá»£i Ã­ch vÃ  chi phÃ­: Chá»‰ Ã¡p dá»¥ng design pattern khi lá»£i Ã­ch vá» kháº£ nÄƒng báº£o trÃ¬, má»Ÿ rá»™ng, hoáº·c dá»… hiá»ƒu vÆ°á»£t trá»™i so vá»›i sá»± phá»©c táº¡p mÃ  nÃ³ mang láº¡i. HÃ£y tá»± há»i: "Pattern nÃ y cÃ³ thá»±c sá»± giÃºp code dá»… hiá»ƒu vÃ  dá»… thay Ä‘á»•i hÆ¡n trong bá»‘i cáº£nh cá»¥ thá»ƒ nÃ y khÃ´ng?"
Cho phÃ©p cÃ¡c cÃ¢u lá»‡nh comment trÆ°á»›c cÃ¡c hÃ m/lá»i gá»i hÃ m Ä‘á»ƒ lÃ m tÆ°á»ng minh hÃ m:
NhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ má»¥c "Comment", comment nÃªn giáº£i thÃ­ch "táº¡i sao" chá»© khÃ´ng pháº£i "cÃ¡i gÃ¬". Náº¿u má»™t Ä‘oáº¡n code phá»©c táº¡p hoáº·c má»™t quyáº¿t Ä‘á»‹nh thiáº¿t káº¿ khÃ´ng trá»±c quan, má»™t comment ngáº¯n gá»n cÃ³ thá»ƒ giÃºp Ã­ch ráº¥t nhiá»u.

Äáº·c biá»‡t há»¯u Ã­ch khi gá»i cÃ¡c hÃ m cÃ³ nhiá»u tham sá»‘ boolean hoáº·c khi logic nghiá»‡p vá»¥ phá»©c táº¡p khÃ´ng thá»ƒ diá»…n táº£ hoÃ n toÃ n qua tÃªn hÃ m.